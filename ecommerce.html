<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>E-commerce with Comments</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#f2f2f2;
  padding-bottom:120px;
}

/* HEADER */
.header{
  display:flex;
  gap:8px;
  padding:10px;
  background:#1b8f4d;
  flex-wrap:wrap;
}
.search-input{
  flex:1;
  padding:10px;
  border:none;
  border-radius:6px;
}
.search-btn{
  padding:10px;
  border:none;
  border-radius:6px;
  background:#fff;
  color:#1b8f4d;
  font-weight:bold;
  cursor:pointer;
}

/* PRODUCTS */
.product-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
  padding:15px;
}
.card{
  background:#fff;
  padding:10px;
  border-radius:10px;
  display:flex;
  flex-direction:column;
  position:relative;
}
.card img{
  width:100%;
  height:150px;
  object-fit:cover;
  border-radius:8px;
  cursor:pointer;
}
.card p{margin:6px 0;font-size:14px;}
.price{color:green;font-weight:bold;}
.order-btn{
  margin-top:auto;
  padding:10px;
  border:none;
  border-radius:6px;
  background:#1b8f4d;
  color:#fff;
  cursor:pointer;
}

/* SOLD */
.sold-badge{
  position:absolute;
  top:10px;
  left:10px;
  background:red;
  color:#fff;
  padding:5px 8px;
  border-radius:6px;
  font-size:12px;
}
.sold-img{filter:grayscale(100%)}
.sold-btn{background:#aaa!important;cursor:not-allowed;}

/* COMMENT SECTION */
.comment-section{
  text-align:left;
  margin-top:10px;
  border-top:1px solid #ccc;
  padding-top:8px;
}
.comment-section h4{
  font-size:14px;
  margin-bottom:6px;
}
.comment{
  border-bottom:1px solid #eee;
  margin-bottom:6px;
  padding-bottom:6px;
  display:flex;
  align-items:center;
}
.comment img{
  max-width:50px;
  max-height:50px;
  margin-left:8px;
  border-radius:6px;
  object-fit:cover;
}

/* COMMENT INPUT */
.comment-input{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-top:6px;
}
.comment-input input[type="text"]{
  flex:1;
  padding:6px;
  border-radius:6px;
  border:1px solid #ccc;
}
.comment-input input[type="file"]{
  padding:6px;
}
.comment-input button{
  padding:6px 12px;
  border:none;
  border-radius:6px;
  background:#1b8f4d;
  color:#fff;
  cursor:pointer;
}

/* MODALS */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  justify-content:center;
  align-items:center;
  z-index:1000;
}

/* IMAGE MODAL */
.image-box{
  text-align:center;
  color:#fff;
  max-width:90%;
}
.image-box img{
  max-width:100%;
  max-height:60vh;
  border-radius:10px;
}
.image-box button{
  margin-top:10px;
  padding:10px 15px;
  border:none;
  border-radius:6px;
  background:#1b8f4d;
  color:#fff;
  cursor:pointer;
}

/* ORDER MODAL */
#orderModal form{
  background:#1b8f4d;
  color:#fff;
  padding:20px;
  width:90%;
  max-width:420px;
  border-radius:14px;
}
#orderModal input,
#orderModal textarea,
#orderModal select,
#orderModal button{
  width:100%;
  margin:6px 0;
  padding:10px;
  border:none;
  border-radius:6px;
}
.cancel-btn{
  background:#fff;
  color:#000;
  cursor:pointer;
}

/* FOOTER */
.footer{
  position:fixed;
  bottom:0;
  width:100%;
  background:#1b8f4d;
  color:#fff;
  text-align:center;
  padding:10px;
}

/* RESPONSIVE */
@media(max-width:480px){
  .card img{height:120px;}
  .comment img{max-width:40px; max-height:40px;}
  .comment-input{flex-direction:column;}
  .comment-input button{width:100%;}
}
</style>
</head>

<body>

<header class="header">
  <input class="search-input" id="searchInput" placeholder="Search products">
  <button class="search-btn" id="searchBtn">Search</button>
</header>

<main class="product-grid" id="productGrid"></main>

<!-- IMAGE MODAL -->
<div id="imageModal" class="modal">
  <div class="image-box">
    <img id="modalImg">
    <h3 id="modalTitle"></h3>
    <p id="modalPrice"></p>
    <button id="modalOrderBtn">Buy Now</button>
  </div>
</div>

<!-- ORDER MODAL -->
<div id="orderModal" class="modal">
<form id="orderForm">
<h3>Confirm Order</h3>

<input name="name" placeholder="Your Name" required>
<input name="email" type="email" placeholder="Your Email" required>
<input name="product" id="productName" readonly>
<input name="price" id="productPrice" readonly>

<select name="payment" required>
  <option value="Cash on Delivery">Cash on Delivery</option>
  <option value="Online Payment on Delivery">Online Payment on Delivery</option>
</select>

<input name="quantity" type="number" min="1" value="1" required>
<textarea name="address" placeholder="Address / Notes"></textarea>
<input name="contact" placeholder="Contact" required>

<button type="submit">Confirm Order</button>
<button type="button" class="cancel-btn" id="closeModal">Cancel</button>
</form>
</div>

<div class="footer">Powered by <b>Anveshan</b></div>

<script>
/* ===== SETTINGS ===== */
const WHATSAPP_NUMBER = "9779761120781";
const FORMSPREE_URL = "https://formspree.io/f/xqeldbro";

/* ===== PRODUCTS ===== */
const products = [
 {name:"A Quiet Light",price:449,img:"b1.jpg",stock:1},
 {name:"Words Left In My Notes",price:449,img:"bb2.png",stock:1},
 {name:"Tws Airpod",price:600,img:"tws.jpg",stock:1},
 {name:"Photo Light Clip",price:500,img:"photo light clip.jpg",stock:1},
 {name:"RGB Mouse",price:350,img:"RGB MOUSE.jpg",stock:1},
 {name:"RGB Keyboard",price:900,img:"rgb.jpg",stock:1},
 {name:"Trimmer",price:400,img:"trimmer.jpg",stock:1},
 {name:"Mini USB Hub",price:450,img:"usb.jpg",stock:1},
 {name:"Canva Pro",price:300,img:"canva.jpg",stock:1},
 {name:"Barcelona Jersey",price:900,img:"barca jersy.jpg",stock:0},
 {name:"CSK Jersey",price:900,img:"csk jersy.jpg",stock:0},
 {name:"Mumbai Indians Jersey",price:900,img:"Mi jersy.jpg",stock:0},
 {name:"Yellow Jersey",price:900,img:"yellow jersy.jpg",stock:0},
 {name:"White and Red Jersey",price:900,img:"white and red jersy.jpg",stock:0}
];

/* ===== ELEMENTS ===== */
const grid=document.getElementById("productGrid");
const searchInput=document.getElementById("searchInput");
const searchBtn=document.getElementById("searchBtn");
const imageModal=document.getElementById("imageModal");
const modalImg=document.getElementById("modalImg");
const modalTitle=document.getElementById("modalTitle");
const modalPrice=document.getElementById("modalPrice");
const modalOrderBtn=document.getElementById("modalOrderBtn");
const orderModal=document.getElementById("orderModal");
const productName=document.getElementById("productName");
const productPrice=document.getElementById("productPrice");
const closeModal=document.getElementById("closeModal");
const orderForm=document.getElementById("orderForm");

/* ===== RENDER PRODUCTS ===== */
function renderProducts(){
 grid.innerHTML="";
 products.forEach(p=>{
  const c=document.createElement("div");
  c.className="card";
  c.innerHTML=`
   <img src="${p.img}" class="${p.stock?"":"sold-img"}">
   ${p.stock?"":'<span class="sold-badge">SOLD OUT</span>'}
   <p>${p.name}</p>
   <p class="price">Rs. ${p.price}</p>
   <button class="order-btn ${p.stock?"":"sold-btn"}" ${p.stock?"":"disabled"}>
     ${p.stock?"Buy Now":"Sold Out"}
   </button>

   <div class="comment-section">
     <h4>Comments:</h4>
     <div class="comment-list"></div>
     <div class="comment-input">
       <input type="text" placeholder="Write a comment">
       <input type="file" accept="image/*">
       <button>Add</button>
     </div>
   </div>
  `;
  grid.appendChild(c);

  c.querySelector("img").onclick=()=>openImage(p);
  if(p.stock) c.querySelector("button").onclick=()=>openOrder(p);

  /* COMMENT FUNCTIONALITY */
  const commentInput = c.querySelector(".comment-input input[type='text']");
  const fileInput = c.querySelector(".comment-input input[type='file']");
  const addBtn = c.querySelector(".comment-input button");
  const commentList = c.querySelector(".comment-list");

  addBtn.onclick = () => {
    if(commentInput.value.trim() === "") return;
    const div = document.createElement("div");
    div.className = "comment";
    div.innerHTML = `<strong>${commentInput.value}</strong>`;
    if(fileInput.files[0]){
      const img = document.createElement("img");
      img.src = URL.createObjectURL(fileInput.files[0]);
      div.appendChild(img);
    }
    commentList.appendChild(div);
    commentInput.value = "";
    fileInput.value = "";
  };
 });
}
renderProducts();

/* ===== IMAGE MODAL ===== */
function openImage(p){
 modalImg.src=p.img;
 modalTitle.textContent=p.name;
 modalPrice.textContent="Rs. "+p.price;
 modalOrderBtn.style.display=p.stock?"block":"none";
 modalOrderBtn.onclick=()=>{imageModal.style.display="none";openOrder(p)};
 imageModal.style.display="flex";
}
imageModal.onclick=e=>{if(e.target===imageModal)imageModal.style.display="none"};

/* ===== ORDER MODAL ===== */
function openOrder(p){
 productName.value=p.name;
 productPrice.value="Rs. "+p.price;
 orderModal.style.display="flex";
}
closeModal.onclick=()=>orderModal.style.display="none";

/* ===== SUBMIT (WHATSAPP â†’ FORMSPREE FALLBACK) ===== */
orderForm.onsubmit=e=>{
 e.preventDefault();
 const f=e.target;

 const data={
  name:f.name.value,
  email:f.email.value,
  product:f.product.value,
  price:f.price.value,
  quantity:f.quantity.value,
  payment:f.payment.value,
  address:f.address.value,
  contact:f.contact.value
 };

 const msg=
`New Order
Name: ${data.name}
Product: ${data.product}
Price: ${data.price}
Qty: ${data.quantity}
Payment: ${data.payment}
Contact: ${data.contact}
Address: ${data.address}`;

 const wa=window.open(
  "https://wa.me/"+WHATSAPP_NUMBER+"?text="+encodeURIComponent(msg),
  "_blank"
 );

 setTimeout(()=>{
  if(!wa || wa.closed){
   fetch(FORMSPREE_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
   }).then(()=>alert("Order submitted successfully!"));
  }
 },1200);

 orderModal.style.display="none";
 f.reset();
};

/* ===== SEARCH ===== */
function searchProducts(){
 const v=searchInput.value.toLowerCase();
 document.querySelectorAll(".card").forEach(c=>{
  c.style.display=c.innerText.toLowerCase().includes(v)?"flex":"none";
 });
}
searchBtn.onclick=searchProducts;
searchInput.onkeyup=searchProducts;
</script>

</body>
</html>
